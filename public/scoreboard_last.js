// Generated by CoffeeScript 1.11.1

    ////////////////////////////
    /* ***********
    */



    function redrawWindow(){
      // ซ้ายสุด 2 % ขวาสุด 2% กลาง 4%   === % = 4+(num-1)*4
        //wth = window.innerWidth;
        team_num = getTeamNum() ; // refresh จำนวนทีม
        wth_box =  (100-( (team_num-1)*3+5))*wth/(team_num*100) ;// แบ่ง % กล่องแต่ละทีม
        //console.log(status);
        for(var i=0 ; i<team_name.length ; i++){
          //console.log(i+' '+team_name[i]+' '+status[i]) ;
          if( team_status[i]=="0" ){
            //$('#box_'+i).css('width','0px');
            $('#box_'+i).addClass('hidden');
            console.log('hidden '+i+' '+team_name[i]+' '+team_status[i]) ;
          }
          else {
            $('#box_'+i).css('width',wth_box);
            $('#logo_'+i).attr('src','/logo/'+team_img[i]+'.png');
            $('#name_'+i).html(team_name[i]);
            $('#bl_score_'+i).css('width',wth_box-(wth_box*0.2));
          }

        }


    }


    var App ={};
    App.init = function () {

      App.socket = io();

      App.socket.on('scoreboard', function (data) {
          console.log('rec ' + JSON.stringify(data));
          if( isset(data,"updateScore") ){
            updateScore(data.score);
          }
          if (isset(data,"refresh") ) {
             location.reload() ;

          }


      });



    };
    function updateScore(ss){
       team_score = ss ;
       for(var i=0 ; i<team_name.length ; i++){
         if( team_status[i]=="0" ){
           //$('#box_'+i).css('width','0px');

         }
         else {
           $('#score_m'+i).html(''+parseInt(   Math.round( (parseFloat(team_score[i]) - parseFloat(team_score[i])*0.2)*10 )   )/10);
           $('#score_'+i).html(team_score[i]);
           $('#score_p'+i).html(''+(team_score[i]+10));

         }

       }
    }


  $(function(){
    redrawWindow();
    updateScore(team_score);
  });
  $(function() {

    return App.init();
  });

  function isset(obj, prop) {
      return typeof obj !== 'undefined' ? obj.hasOwnProperty(prop) : false;
  }

  function getTeamNum(){
    var temp = 0;
    for(var i=0 ; i < team_name.length ; i++ ){
      if( team_status[i] != "0" )temp++ ;
    }
    return temp ;
  }

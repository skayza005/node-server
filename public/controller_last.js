// Generated by CoffeeScript 1.11.1

    ////////////////////////////
    /* ***********
    */


  var App = {};
  var drawing;
  var mousePos;
  var lastPos;
  var rect;
  var drawingByAnother;
  var bool_sent = 0;

  /*
  	Init
   */
   $(function() {
      for(var i=1 ; i<team_num ; i++){
        $('#name'+i).html(team_name[i]);
        $('#score'+i).html(team_score[i]);
        if( team_status[i]==1){$('#status'+i).css("background-color", "#286090");  }
        else {$('#status'+i).css("background-color", "#ddd");  }
      }
      console.log(status);

   });

  ///// อาจมีฟังชั่น redraw เวลารีเฟรชใหม่

  App.init = function () {

    App.socket = io();
    App.socket.on('controller', function (data) {
        console.log('rec ' + JSON.stringify(data));
         if (isset(data,"result") ) {
             //$('#score_new'+data.tablet).html(data.time/1000) ;
             $('#time'+data.tablet).html(data.time/1000) ;
             if( data.result ){ $('#time'+data.tablet).addClass('bg-success');$('#newscore'+data.tablet).html('10');}
             else { $('#time'+data.tablet).addClass('bg-danger');$('#newscore'+data.tablet).html('-'+team_score[data.tablet]*0.2);}

          }
          if (isset(data,"refresh") ) {
             location.reload() ;

          }
/*
        if (isset(data,"clear") ) { return ClearData(App.ctx,App.canvas); }
        if (isset(data,"resetTime") ) { resetTime(); }

        else {

            //console.log('rec: ' + data.lP.x + ' ' + data.lP.y + ' ' + data.mP.x + ' ' + data.mP.y);

            lastPos = data.lP;
            mousePos = data.mP
            drawingByAnother = true;
            renderCanvas();
            drawingByAnother = false;
        }
        */
    });
    reset_time.onclick = function () { App.socket.emit('controller', { resetTime: '60' }); };
    start_time.onclick = function () { App.socket.emit('controller', { startTime: '60' }); };
    stop_time.onclick = function () { App.socket.emit('controller', { stop: true }); };
    sent_result.onclick = function () { App.socket.emit('controller', { sentResult: true }); };
    update_score.onclick = function () { App.socket.emit('controller', { updateScore_last: true }); };
    update_status.onclick = function () { App.socket.emit('controller', { updateStatus: true ,status:status}); };
    reset_new.onclick = function () { App.socket.emit('controller', { resetAndNext: true });location.reload() ; };

      /////////////////////////////
      //////mouse
      ////////////////////////////



  };



  $(function() {
    return App.init();
  });

  function isset(obj, prop) {
      return typeof obj !== 'undefined' ? obj.hasOwnProperty(prop) : false;
  }

  function updateStatus(team , sss ){
    App.socket.emit('controller', { updateStatus: true ,team:team ,status:sss }) ;
    if( sss==1){$('#status'+team).css("background-color", "#286090");  }
    else {$('#status'+team).css("background-color", "#ddd");  }
  }

  function sentSubmit() {
      bool_sent = 1;
      App.socket.emit('tablet1', { submit:true ,sent_Time: sent_Time });

  }
  function resetScreen() {

  }
